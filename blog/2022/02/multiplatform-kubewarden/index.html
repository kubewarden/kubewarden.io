<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Multiplatform Kubewarden</title><link rel=stylesheet type=text/css href=/sass/blog.min.css?1651498001><script async defer src=https://buttons.github.io/buttons.js></script><script type=text/javascript src=//cdn.bizible.com/scripts/bizible.js async></script></head><body><header><div class=sub-header><a href><img src=/images/logo-kubewarden.svg alt=Kubewarden></a>
<a href=#main-menu id=main-menu-toggle class=menu-toggle aria-label="Open main menu"><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><nav id=main-menu class=main-menu aria-label="Main menu"><a href=#main-menu-toggle id=main-menu-close class=menu-close aria-label="Close main menu"><span class=sr-only>Close main menu</span>
<span class="fa fa-close" aria-hidden=true></span></a><h2 id=main-menu-heading class=sr-only>Main menu</h2><ul class=menu><li><a href=https://hub.kubewarden.io/ target=_blank class="btn no-bg">Policy Hub</a></li><li><a href=https://charts.kubewarden.io/ target=_blank class="btn no-bg">Helm Charts</a></li><li><a href=https://docs.kubewarden.io/ target=_blank class="btn no-bg">Docs</a></li><li><a href="https://kubernetes.slack.com/?redir=%2Fmessages%2Fkubewarden" target=_blank class="btn no-bg">Slack</a></li><li><a href=https://twitter.com/kubewarden target=_blank class="btn no-bg">Twitter</a></li><li><a href=https://kubewarden.io/blog target=_blank class="btn no-bg">Blog</a></li><li><a href=https://github.com/kubewarden class="btn github"><img src=/images/icon-github.svg><span>Github</span></a></li></ul></nav><a href=#main-menu-toggle class=backdrop tabindex=-1 aria-hidden=true hidden></a></div></header><link rel=stylesheet href=/css/blog.css><section class=intro><div class=bg-primary><div class="wrap grid-one"><div><h1 style=color:#fff><a href=/blog>The Kubewarden blog</a>
<a href=/blog/index.xml><img src=/images/icon-rss.svg class=fill-white height=20></a></h1></div></div></div></section><main><section class=wrap><article><h1>Multiplatform Kubewarden</h1><p>Author: <author>Rafael Fernández López</author></p><p>Published: <time>04 Feb 2022</time></p><p>Updated: <time>02 May 2022</time></p><div id=blog-post-content><p>The Kubewarden team is glad to announce that in the spirit of helping
Policy Authors and Cluster Administrators, the project is now
officially multiplatform.</p><p>The list of supported platforms as of now are:</p><ul><li><p>Policy Server, as a <a href=https://github.com/kubewarden/policy-server/pkgs/container/policy-server>container image</a>:</p><ul><li><code>linux/amd64</code> (with the <code>musl</code> libc)</li><li><code>linux/arm64</code> (with the <code>musl</code> libc)</li></ul></li><li><p>kwctl, as a <a href=https://github.com/kubewarden/kwctl/releases>standalone binary</a>:</p><ul><li><code>darwin</code> (<code>x86_64</code>)</li><li><code>linux</code> (<code>aarch64</code>, with the <code>musl</code> libc)</li><li><code>linux</code> (<code>x86_64</code>, with the <code>musl</code> libc)</li><li><code>windows</code> (<code>x86_64</code>, with <code>MSVC</code>)</li></ul></li></ul><p>We have prioritized the usage of the same dependencies and toolchain
on platforms where we were able to do so.</p><h2 id=looking-for-platform-convergence>Looking for platform convergence</h2><p>Initially, we were using <code>glibc</code> and <code>openssl</code> as dependencies in our
project. However, these two libraries are somewhat special and
sometimes problematic to converge into other platforms.</p><p>Here is a short summary of the lessons learned, sometimes the hard way,
for both libraries.</p><h3 id=the-libc>The libc</h3><p>In the early stages of development, the Kubewarden team decided to use the <a href=https://musl.libc.org/><code>musl libc</code></a> library.
This allowed us to avoid potential difficulties with <code>glibc</code> down the road (i.e., Cross-compilation time or making a full static binary).</p><p>The team also thinks that producing a final static binary for all platforms is in our users' own interests, especially for a CLI tool like <code>kwctl</code>, which interacts directly with our users' environment.</p><h3 id=the-ssl-stack>The SSL stack</h3><p>The second part of the puzzle is <code>openssl</code>. It&rsquo;s also a complex piece
of software.</p><p>As stated above, we are interested in cross compiling for multiple
operating systems such as Windows and macOS (Darwin).</p><p>Luckily for us, a new TLS implementation has popped up in the Rust
ecosystem: <a href=https://github.com/rustls/rustls>rustls</a>. Thanks to
<code>rustls</code>, it&rsquo;s now easier to produce a final binary of <code>kwctl</code> that
will work on all major platforms. And all of that is from the same source
code.</p><h2 id=closing>Closing</h2><p>These decisions might seem very technical or bring less
value as other features. But for the Kubewarden team, it&rsquo;s important
we provide a solution that is suitable for as many people as
possible.</p><p>And at the same time, we are trying to keep the project as convergent as
possible, by reducing the number of critical, high-complexity
dependencies we use in our code base.</p><blockquote><p>Note: <a href=https://github.com/kubewarden/kwctl/issues/124><code>kwctl</code> is not building
yet</a> on Apple
Silicon (macOS). We are following this closely and will release the
new architecture as soon as it&rsquo;s possible.</p><p>In the meantime, you&rsquo;ll have to fall back to <code>rosetta</code> in this
environment, so you can use the <code>x86_64</code> version of <code>kwctl</code>.</p></blockquote><p>Try <a href=https://docs.kubewarden.io/quick-start.html>Kubewarden</a> in as
many places as you want! We are eagerly looking for your feedback!</p></div><div><ul id=tags></ul></div><div></div></article></section></main><footer><p>&copy; 2022 SUSE. Kubewarden is an open source project of the <a href=https://suse.com>SUSE</a>
<a href=https://rancher.com>Rancher</a> Engineering group.</p><div class=project-icons><a href=https://k3s.io target=blank><img src=/images/icon-k3s.svg height=20></a>
<a href=https://harvesterhci.io target=blank><img src=/images/icon-harvester.svg height=20></a>
<a href=https://rancherdesktop.io target=blank><img src=/images/icon-rancher-desktop.svg height=20></a>
<a href=https://epinio.io target=blank><img src=/images/icon-epinio.svg height=20></a>
<a href=https://hypper.io target=blank><img src=/images/icon-hypper.svg height=20></a></div></footer><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-56382716-13','auto'),ga('set','anonymizeIp',!0),ga('send','pageview'))</script></body></html>