<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Ingress-nginx CVE-2025-1974 - how Kubewarden can help you</title><link rel=icon type=image/svg href=/favicon.svg><link rel=mask-icon href=/favicon.svg><link rel=stylesheet type=text/css href=/sass/blog.min.css?1745308760><script async defer src=https://buttons.github.io/buttons.js></script><script type=text/javascript src=//cdn.bizible.com/scripts/bizible.js async></script></head><body><header><div class=sub-header><a href><img src=/images/logo-kubewarden.svg alt=Kubewarden></a>
<a href=#main-menu id=main-menu-toggle class=menu-toggle aria-label="Open main menu"><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><nav id=main-menu class=main-menu aria-label="Main menu"><a href=#main-menu-toggle id=main-menu-close class=menu-close aria-label="Close main menu"><span class=sr-only>Close main menu</span>
<span class="fa fa-close" aria-hidden=true></span></a><h2 id=main-menu-heading class=sr-only>Main menu</h2><ul class=menu><li><a href="https://artifacthub.io/packages/search?kind=13&sort=relevance&page=1" target=_blank class="btn no-bg">Policies</a></li><li><a href=https://charts.kubewarden.io/ target=_blank class="btn no-bg">Helm Charts</a></li><li><a href=https://docs.kubewarden.io/ target=_blank class="btn no-bg">Docs</a></li><li><a href="https://kubernetes.slack.com/?redir=%2Fmessages%2Fkubewarden" target=_blank class="btn no-bg">Slack</a></li><li><a href=https://bsky.app/profile/kubewarden.io target=_blank class="btn no-bg">Bluesky</a></li><li><a href=https://hachyderm.io/@kubewarden rel=me target=_blank class="btn no-bg">Mastodon</a></li><li><a href=/#get-in-touch target=_blank class="btn no-bg">Community</a></li><li><a href=/blog target=_blank class="btn no-bg">Blog</a></li><li><a href=https://docs.kubewarden.io/enterprise target=_blank class="btn no-bg">Enterprise</a></li><li><a href=https://github.com/kubewarden class="btn github"><img src=/images/icon-github.svg><span>Github</span></a></li></ul></nav><a href=#main-menu-toggle class=backdrop tabindex=-1 aria-hidden=true hidden></a></div></header><link rel=stylesheet href=/css/blog.css><section class=intro><div class=bg-primary><div class="wrap grid-one"><div><h1 style=color:#fff><a href=/blog>The Kubewarden blog</a>
<a href=/blog/index.xml><img src=/images/icon-rss.svg class=fill-white height=20></a></h1></div></div></div></section><main><section class=wrap><article><h1>Ingress-nginx CVE-2025-1974 - how Kubewarden can help you</h1><p>Author: <author>Flavio Castelli</author></p><p>Published: <time>03 Apr 2025</time></p><p>Updated: <time>22 Apr 2025</time></p><div id=blog-post-content><p>Last week, a high severity issue <a href=https://nvd.nist.gov/vuln/detail/CVE-2025-1974>CVE-2025-1974</a>
was found affecting ingress-nginx, one of the most used ingress solutions for Kubernetes.</p><h2 id=the-issue>The issue</h2><p>The issue allows an attacker to execute arbitrary code in the Pod running the
controller. The attacker can then steal the Kubernetes identity of the nginx-ingress
controller which, by design, has access to all the Secrets defined in the cluster.</p><p>The issue is exploited by making http requests against the validating webhook server used
by the nginx-ingress controller. Only the Kubernetes API server should be allowed to make
requests against the webhook endpoint.
However, it was discovered that certain clusters are even exposing this webhook endpoint
outside of the cluster, for example by using an <code>Ingress</code> resource.</p><h2 id=how-kubewarden-can-help-you>How Kubewarden can help you</h2><p>Two new Kubewarden policies have been created to help Kubernetes administrators.</p><h3 id=identify-webhook-endpoints-that-are-accidentally-exposed>Identify webhook endpoints that are accidentally exposed</h3><p>The first policy, named <a href=https://github.com/kubewarden/do-not-expose-admission-controller-webhook-services-policy><code>do-not-expose-admission-controller-webhook-services</code></a>,
validates the creation and update of <code>ValidatingWebhookConfiguration</code> and <code>MutatingWebhookConfiguration</code>
resources.</p><p>The policy queries the Kubernetes API to identify services exposed externally via Ingress resources.</p><h2 id=block-dangerous-nginx-ingress-annotation>Block dangerous nginx-ingress annotation</h2><p>The second policy, written by a community member, is named <a href=https://github.com/hierynomus/ingressnightmare-policy><code>ingressnightmare-policy</code></a>.
The policy validates <code>Ingress</code> resources and prevents the usage of some, but not all, dangerous nginx-ingress annotations
that can be abused as described in CVE-2025-1974.</p><h2 id=audit-scanner>Audit Scanner</h2><p>These policies can also help identify existing workloads that may be vulnerable to CVE-2025-1974.</p><p>Using the <a href=https://docs.kubewarden.io/explanations/audit-scanner/policy-reports>audit scanner feature</a>,
Kubernetes administrators can detect and flag the following resources:</p><ul><li><code>(Validating|Mutating)WebhookConfiguration</code> objects that rely on publicly exposed webhook endpoints.</li><li><code>Ingress</code> objects that could be exploited by attackers because of the usage of unsafe annotations.</li></ul><p>Once flagged by Kubewarden, you can review and remediate these resources to enhance the cluster&rsquo;s
security posture.</p><h2 id=getting-in-touch>Getting in touch</h2><p>As always, we welcome your feedback and contributions. Feel free to reach out
to us on <a href="https://kubernetes.slack.com/?redir=%2Fmessages%2Fkubewarden">Slack</a>
and <a href=https://github.com/orgs/kubewarden/discussions>GitHub discussions</a>.</p></div><div><ul id=tags></ul></div><div></div></article></section></main><footer><p>&copy; 2025 Kubewarden Project Authors. All rights reserved.
The Linux Foundation has registered trademarks and uses trademarks.
For a list of trademarks of The Linux Foundation, please see our Trademark Usage page:
<a href=https://www.linuxfoundation.org/trademark-usage>https://www.linuxfoundation.org/trademark-usage</a></p></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-PSW07XK7TM"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-PSW07XK7TM',{anonymize_ip:!0})}</script></body></html>