<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Introducing Kubewarden WASI policies</title><link rel=icon type=image/svg href=/favicon.svg><link rel=mask-icon href=/favicon.svg><link rel=stylesheet type=text/css href=/sass/blog.min.css?1746016062><script async defer src=https://buttons.github.io/buttons.js></script><script type=text/javascript src=//cdn.bizible.com/scripts/bizible.js async></script></head><body><header><div class=sub-header><a href><img src=/images/logo-kubewarden.svg alt=Kubewarden></a>
<a href=#main-menu id=main-menu-toggle class=menu-toggle aria-label="Open main menu"><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><nav id=main-menu class=main-menu aria-label="Main menu"><a href=#main-menu-toggle id=main-menu-close class=menu-close aria-label="Close main menu"><span class=sr-only>Close main menu</span>
<span class="fa fa-close" aria-hidden=true></span></a><h2 id=main-menu-heading class=sr-only>Main menu</h2><ul class=menu><li><a href="https://artifacthub.io/packages/search?kind=13&sort=relevance&page=1" target=_blank class="btn no-bg">Policies</a></li><li><a href=https://charts.kubewarden.io/ target=_blank class="btn no-bg">Helm Charts</a></li><li><a href=https://docs.kubewarden.io/ target=_blank class="btn no-bg">Docs</a></li><li><a href="https://kubernetes.slack.com/?redir=%2Fmessages%2Fkubewarden" target=_blank class="btn no-bg">Slack</a></li><li><a href=https://bsky.app/profile/kubewarden.io target=_blank class="btn no-bg">Bluesky</a></li><li><a href=https://hachyderm.io/@kubewarden rel=me target=_blank class="btn no-bg">Mastodon</a></li><li><a href=/#get-in-touch target=_blank class="btn no-bg">Community</a></li><li><a href=/blog target=_blank class="btn no-bg">Blog</a></li><li><a href=https://docs.kubewarden.io/enterprise target=_blank class="btn no-bg">Enterprise</a></li><li><a href=https://github.com/kubewarden class="btn github"><img src=/images/icon-github.svg><span>Github</span></a></li></ul></nav><a href=#main-menu-toggle class=backdrop tabindex=-1 aria-hidden=true hidden></a></div></header><link rel=stylesheet href=/css/blog.css><section class=intro><div class=bg-primary><div class="wrap grid-one"><div><h1 style=color:#fff><a href=/blog>The Kubewarden blog</a>
<a href=/blog/index.xml><img src=/images/icon-rss.svg class=fill-white height=20></a></h1></div></div></div></section><main><section class=wrap><article><h1>Introducing Kubewarden WASI policies</h1><p>Author: <author>Flavio Castelli</author></p><p>Published: <time>24 Oct 2023</time></p><p>Updated: <time>30 Apr 2025</time></p><div id=blog-post-content><p>Kubewarden policies can be written using either a <a href=https://docs.kubewarden.io/writing-policies>traditional programming language</a> (like Go, Rust, C#, Swift, â€¦) or using a domain-specific language like <a href=https://docs.kubewarden.io/writing-policies/rego/intro-rego>Rego</a>.
It is required that the programming language can generate the necessary WebAssembly module for use by Kubewarden.</p><p>When using a traditional programming language, the communication between the
host executing the policy and the WebAssembly guest (the actual policy) uses the
<a href=https://wapc.io/>waPC</a> communication protocol.
This protocol provides a bidirectional channel between the host and guest.
It allows us to expose extra capabilities to policies (like cryptographic signature verification via Sigstore and <a href=https://docs.kubewarden.io/writing-policies/spec/host-capabilities/intro-host-capabilities>more</a>).
We can also grant read access to selected Kubernetes resources (see <a href=https://docs.kubewarden.io/explanations/context-aware-policies>context-aware policies</a>).</p><p>The target language used to write the policy must provide a waPC guest driver.
Writing such a driver is a one-time job that is not complex.
For example, we&rsquo;ve written the Swift and the C# drivers and found them to be straightforward.
However, there are special circumstances when writing this driver is not possible.
This is the case with WebAssembly modules produced by the official Go compiler (not to be confused with those produced by the TinyGo compiler).</p><h2 id=go-and-server-side-wasm>Go and server-side Wasm</h2><p>The Go 1.21 compiler introduces support for WebAssembly modules that can be run on the server side.
Before this release, the official compiler was able to produce only WebAssembly modules that could be run by a web browser.
<a href=https://tinygo.org/>TinyGo</a> does an excellent job of producing server side WebAssembly modules but there are still some complex Go codebases that cannot be compiled by it.</p><p>The Go 1.21 release introduces support for the <a href=https://wasi.dev/>WebAssembly System Interface</a> (aka <em>&ldquo;WASI&rdquo;</em>)
with the new <code>GOOS</code> named <a href=https://tip.golang.org/doc/go1.21#wasip1><code>wasip1</code></a>.</p><p>Unfortunately, due to <a href=https://github.com/golang/go/issues/42372>this issue</a>, it&rsquo;s not yet
possible to use the waPC guest driver inside of WebAssembly modules built by the official
compiler.
This is where the new Kubewarden WASI policy type becomes useful.</p><h2 id=a-new-policy-type>A new policy type</h2><p>With the Kubewarden 1.7 release, a new type of policy has been introduced:
<a href=https://docs.kubewarden.io/writing-policies/wasi><code>WASI</code></a>
policies.</p><p>To produce a Kubewarden WASI policy, the policy author writes a traditional CLI program.
The program will obtain the evaluation payload from <code>STDIN</code> and writes the evaluation response on <code>STDERR</code>.
This completely removes the dependency on waPC.</p><h2 id=a-concrete-example>A concrete example</h2><p>Kubewarden aims to become the universal policy framework for Kubernetes.
We don&rsquo;t want to prescribe how policy authors should write their policies.
In contrast, we intend to provide a flexible way to express rules and constraints.</p><p>As part of this aim,
we wanted to support the <a href=https://kyverno.io/docs/writing-policies/>YAML-based DSL</a> used by Kyverno to write policies.</p><p>Kyverno is written using Go, so we tried to compile its policy evaluation engine to WebAssembly.
However, its codebase is too complex for TinyGo, but not for the official Go compiler.</p><p>By using Go 1.21 and the new Kubewarden WASI policy type,
we have been able to implement <a href=https://github.com/kubewarden/kyverno-dsl-policy>this</a> experimental policy allowing Kubewarden to reuse certain Kyverno policies.</p><h2 id=summary>Summary</h2><p>Starting with Kubewarden 1.7 policy authors can write policies using programming languages not yet supported by waPC or by Kubewarden SDKs.
The only requirement for these languages is to support the WASI compilation target.</p><p>Using WASI policies has <a href=https://docs.kubewarden.io/writing-policies/wasi#limitations>several limitations</a>, so should be done only under special circumstances.</p><p>Let us know what you think about this new policy type.
We are especially interested to know what you&rsquo;re building with it.</p><p>If you would like to write Kubewarden policies using a programming language that we don&rsquo;t yet support,
please <a href=https://kubernetes.slack.com/archives/kubewarden>reach out to us</a>.
We would be happy to look at implementing this feature with you.</p></div><div><ul id=tags></ul></div><div></div></article></section></main><footer><p>&copy; 2025 Kubewarden Project Authors. All rights reserved.
The Linux Foundation has registered trademarks and uses trademarks.
For a list of trademarks of The Linux Foundation, please see our Trademark Usage page:
<a href=https://www.linuxfoundation.org/trademark-usage>https://www.linuxfoundation.org/trademark-usage</a></p></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-PSW07XK7TM"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-PSW07XK7TM',{anonymize_ip:!0})}</script></body></html>